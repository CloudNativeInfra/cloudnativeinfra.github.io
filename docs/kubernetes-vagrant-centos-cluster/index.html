<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.40" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Setting up a Kubernetes cluster with Vagrant </title>

  
  <meta name="description" content="Setup a kubernetes cluster with one key and addons included."> 
  
  
  
  
  

  

  <meta name="author" content="CloudNativeGo.com">


  <meta property="og:title" content="Setting up a Kubernetes cluster with Vagrant" />
<meta property="og:description" content="Setup a kubernetes cluster with one key and addons included." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloudnativego.com/docs/kubernetes-vagrant-centos-cluster/" />



<meta property="article:published_time" content="2018-05-11T23:26:36&#43;08:00"/>

<meta property="article:modified_time" content="2018-05-11T23:26:36&#43;08:00"/>











  




  
  
  
  
  

  <link rel="canonical" href="https://cloudnativego.com/docs/kubernetes-vagrant-centos-cluster/">  

  <link rel="shortcut icon" type="image/png" href="data:image/png;base64,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">


  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">

  <link href="/css/custom.css" rel="stylesheet" type="text/css">
  <link href="/css/prism.css" rel="stylesheet" type="text/css">

  <script type="text/javascript" src="/js/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="/js/tocbot.min.js"></script>
  <script type="text/javascript" src="/js/prism.js"></script>
</head>


<body class="page-kube">
  <header> <div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">Cloud Native Go!</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">Cloud Native Go!</a>
    </div>
    <nav id="top-nav-main">
      <ul>
       
       
    <li><a href="/blog/" >Blog</a></li>
    
    <li><a href="/docs/" >Docs</a></li>
    
    <li><a href="/faq/" >Faq</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra"> 
      <ul>
          
      </ul>
    </nav>
  </div>
  
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c889b4cfd2df3f575151a52b18610b26";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
 </header>
  <main>
  <div id="main">
    <div id="hero">
      <h1> Setting up a Kubernetes cluster with Vagrant </h1>
      <p class="hero-lead">
           Using vagrant file to build a kubernetes cluster which consists of 1 master(also as node) and 3 nodes. You don't have to create complicated ca files or configuration.
      </p>

    </div> 
    <div id="kube-component" class="content">
    
<nav id="contents">
    <ol class="js-toc">
    </ol>
</nav>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded",
function(){
tocbot.init({

tocSelector: '.js-toc',

contentSelector: '.content',

headingSelector: 'h3'
})
}
);
</script>



    

<p><a href="https://github.com/rootsongjc/kubernetes-vagrant-centos-cluster/">See in GitHub</a></p>

<p>Using vagrant file to build a kubernetes cluster which consists of 1 master(also as node) and 3 nodes. You don&rsquo;t have to create complicated ca files or configuration.</p>

<h3 id="why-don-t-we-use-kubeadm">Why don&rsquo;t we use kubeadm</h3>

<p>Because I want to setup the etcd, apiserver, controller, scheduler without docker container.</p>

<h3 id="architecture">Architecture</h3>

<p>We will create a Kubernetes 1.9.1+ cluster with 3 nodes which contains the components below:</p>

<table>
<thead>
<tr>
<th>IP</th>
<th>Hostname</th>
<th>Componets</th>
</tr>
</thead>

<tbody>
<tr>
<td>172.17.8.101</td>
<td>node1</td>
<td>kube-apiserver, kube-controller-manager, kube-scheduler, etcd, kubelet, docker, flannel, dashboard</td>
</tr>

<tr>
<td>172.17.8.102</td>
<td>node2</td>
<td>kubelet, docker, flannel、traefik</td>
</tr>

<tr>
<td>172.17.8.103</td>
<td>node3</td>
<td>kubelet, docker, flannel</td>
</tr>
</tbody>
</table>

<p>The default setting will create the private network from 172.17.8.101 to 172.17.8.103 for nodes, and it will use the host&rsquo;s DHCP for the public ip.</p>

<p>The kubernetes service&rsquo;s vip range is <code>10.254.0.0/16</code>.</p>

<p>The container network range is <code>170.33.0.0/16</code> owned by flanneld with <code>host-gw</code> backend.</p>

<p><code>kube-proxy</code> will use <code>ipvs</code> mode.</p>

<h3 id="usage">Usage</h3>

<h4 id="prerequisite">Prerequisite</h4>

<ul>
<li>Host server with 8G+ mem(More is better), 60G disk, 8 core cpu at lease</li>
<li>vagrant 2.0+</li>
<li>virtualbox 5.0+</li>
<li>Maybe need to access the internet through GFW to download the kubernetes files</li>
</ul>

<h4 id="support-addon">Support Addon</h4>

<p><strong>Required</strong></p>

<ul>
<li>CoreDNS</li>
<li>Dashboard</li>
<li>Traefik</li>
</ul>

<p><strong>Optional</strong></p>

<ul>
<li>Heapster + InfluxDB + Grafana</li>
<li>ElasticSearch + Fluentd + Kibana</li>
<li>Istio service mesh</li>
<li>Helm</li>
</ul>

<h4 id="setup">Setup</h4>

<p>Download kubernetes binary release first and move them to this git repo.</p>

<pre><code class="language-bash">git clone https://github.com/rootsongjc/kubernetes-vagrant-centos-cluster.git
cd kubernetes-vagrant-centos-cluster
vagrant up
</code></pre>

<p>Before you run <code>vagrant up</code> make sure this repo directory include the flowing files:</p>

<ul>
<li>kubernetes-client-linux-amd64.tar.gz</li>
<li>kubernetes-server-linux-amd64.tar.gz</li>
</ul>

<p>Wait about 10 minutes the kubernetes cluster will be setup automatically.</p>

<p><strong>Note</strong></p>

<p>If you have difficult to vagrant up the cluster because of have no way to downlaod the <code>centos/7</code> box, you can download the box and add it first.</p>

<p><strong>Add centos/7 box manually</strong></p>

<pre><code class="language-bash">wget -c http://cloud.centos.org/centos/7/vagrant/x86_64/images/CentOS-7-x86_64-Vagrant-1801_02.VirtualBox.box
vagrant box add CentOS-7-x86_64-Vagrant-1801_02.VirtualBox.box --name centos/7
</code></pre>

<p>The next time you run <code>vagrant up</code>, vagrant will import the local box automatically.</p>

<h4 id="connect-to-kubernetes-cluster">Connect to kubernetes cluster</h4>

<p>There are 3 ways to access the kubernetes cluster.</p>

<p><strong>local</strong></p>

<p>Copy <code>conf/admin.kubeconfig</code> to <code>~/.kube/config</code>, using <code>kubectl</code> CLI to access the cluster.</p>

<pre><code>mkdir -p ~/.kube
cp conf/admin.kubeconfig ~/.kube/config
</code></pre>

<p>We recommend this way.</p>

<p><strong>VM</strong></p>

<p>Login to the virtual machine to access and debug the cluster.</p>

<pre><code class="language-bash">vagrant ssh node1
sudo -i
kubectl get nodes
</code></pre>

<p><strong>Kubernetes dashbaord</strong></p>

<p>Kubernetes dashboard URL: <a href="https://172.17.8.101:8443/">https://172.17.8.101:8443</a></p>

<p>Get the token:</p>

<pre><code class="language-bash">kubectl -n kube-system describe secret `kubectl -n kube-system get secret|grep admin-token|cut -d &quot; &quot; -f1`|grep &quot;token:&quot;|tr -s &quot; &quot;|cut -d &quot; &quot; -f2
</code></pre>

<p><strong>Note</strong>: You can see the token message from <code>vagrant up</code> logs.</p>

<h3 id="components-installed">Components installed</h3>

<p><strong>Heapster monitoring</strong></p>

<p>Run this command on you local machine.</p>

<pre><code class="language-bash">kubectl apply -f addon/heapster/
</code></pre>

<p>Append the following item to you local <code>/etc/hosts</code> file.</p>

<pre><code class="language-bash">172.17.8.102 grafana.jimmysong.io
</code></pre>

<p>Open the URL in your browser: <a href="http://grafana.jimmysong.io/">http://grafana.jimmysong.io</a></p>

<p><strong>Treafik ingress</strong></p>

<p>Run this command on you local machine.</p>

<pre><code class="language-bash">kubectl apply -f addon/traefik-ingress
</code></pre>

<p>Append the following item to you local <code>/etc/hosts</code> file.</p>

<pre><code class="language-bash">172.17.8.102 traefik.jimmysong.io
</code></pre>

<p>Traefik UI URL: <a href="http://traefik.jimmysong.io/">http://traefik.jimmysong.io</a></p>

<p><strong>EFK</strong></p>

<p>Run this command on your local machine.</p>

<pre><code class="language-bash">kubectl apply -f addon/heapster/
</code></pre>

<p><strong>Note</strong>: Powerful CPU and memory allocation required. At least 4G per virtual machine.</p>

<p><strong>Helm</strong></p>

<p>Run this command on your local machine.</p>

<pre><code class="language-bash">hack/deploy-helm.sh
</code></pre>

<h4 id="service-mesh">Service Mesh</h4>

<p>We use <a href="https://istio.io/">istio</a> as the default service mesh.</p>

<p><strong>Installation</strong></p>

<pre><code class="language-bash">kubectl apply -f addon/istio/
</code></pre>

<p><strong>Run sample</strong></p>

<pre><code class="language-bash">kubectl apply -n default -f &lt;(istioctl kube-inject -f yaml/istio-bookinfo/bookinfo.yaml)
</code></pre>

<p>Add the following items into <code>/etc/hosts</code> in your local machine.</p>

<pre><code class="language-bash">172.17.8.102 grafana.istio.jimmysong.io
172.17.8.102 servicegraph.istio.jimmysong.io
172.17.8.102 zipkin.istio.jimmysong.io
</code></pre>

<p>We can see the services from the following URLs.</p>

<table>
<thead>
<tr>
<th>Service</th>
<th>URL</th>
</tr>
</thead>

<tbody>
<tr>
<td>grafana</td>
<td><a href="http://grafana.istio.jimmysong.io/">http://grafana.istio.jimmysong.io</a></td>
</tr>

<tr>
<td>servicegraph</td>
<td><a href="http://servicegraph.istio.jimmysong.io/dotviz">http://servicegraph.istio.jimmysong.io/dotviz</a>, <a href="http://servicegraph.istio.jimmysong.io/graph">http://servicegraph.istio.jimmysong.io/graph</a></td>
</tr>

<tr>
<td>zipkin</td>
<td><a href="http://zipkin.istio.jimmysong.io/">http://zipkin.istio.jimmysong.io</a></td>
</tr>

<tr>
<td>productpage</td>
<td><a href="http://172.17.8.101:32000/productpage">http://172.17.8.101:32000/productpage</a></td>
</tr>
</tbody>
</table>

<p>More detail see <a href="https://istio.io/docs/guides/bookinfo.html">https://istio.io/docs/guides/bookinfo.html</a></p>

<h3 id="operation">Operation</h3>

<p>Except for special claim, execute the following commands under the current git repo root directory.</p>

<h4 id="suspend">Suspend</h4>

<p>Suspend the current state of VMs.</p>

<pre><code class="language-bash">vagrant suspend
</code></pre>

<h4 id="resume">Resume</h4>

<p>Resume the last state of VMs.</p>

<pre><code class="language-bash">vagrant resume
</code></pre>

<p>Note: every time you resume the VMs you will find that the machine time is still at you last time you suspended it. So consider to halt the VMs and restart them.</p>

<h4 id="restart">Restart</h4>

<p>Halt the VMs and up them again.</p>

<pre><code class="language-bash">vagrant halt
vagrant up
# login to node1
vagrant ssh node1
# run the prosivision scripts
/vagrant/hack/k8s-init.sh
exit
# login to node2
vagrant ssh node2
# run the prosivision scripts
/vagrant/hack/k8s-init.sh
exit
# login to node3
vagrant ssh node3
# run the prosivision scripts
/vagrant/hack/k8s-init.sh
sudo -i
cd /vagrant/hack
./deploy-base-services.sh
exit
</code></pre>

<p>Now you have provisioned the base kubernetes environments and you can login to kubernetes dashboard, run the following command at the root of this repo to get the admin token.</p>

<pre><code class="language-bash">hack/get-dashboard-token.sh
</code></pre>

<p>Following the hint to login.</p>

<h4 id="clean">Clean</h4>

<p>Clean up the VMs.</p>

<pre><code class="language-bash">vagrant destroy
rm -rf .vagrant
</code></pre>

<h4 id="note">Note</h4>

<p>Only use for development and test, don&rsquo;t use it in production environment.</p>

<h3 id="reference">Reference</h3>

<ul>
<li><a href="https://jimmysong.io/kubernetes-handbook/">Kubernetes Handbook - jimmysong.io</a></li>
<li><a href="https://github.com/duffqiu/centos-vagrant">duffqiu/centos-vagrant</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/tree/master/pkg/proxy/ipvs">kubernetes ipvs</a></li>
</ul>


    
    </div>
  </div>
</main>
  <footer>   <footer id="footer">
    <nav>
      <ul>
        <li><span>Cloud Native Go!</span></li>
        <li>
          <a href="/blog/">Blog</a>
        </li>
          <li>
          <a href="/docs/">Docs</a>
        </li>
        </li>
          <li>
          <a href="/faq/">Faq</a>
        </li>
        <li>
        <li>
          <a href="https://twitter.com/jimmysongio">Give a shout-out on Twitter!</a>
        </li>
      </ul>
    </nav>
    <p>&copy;2018 CloudNativeGo.com</p>
  </footer>
 </footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
</body>

</html>
